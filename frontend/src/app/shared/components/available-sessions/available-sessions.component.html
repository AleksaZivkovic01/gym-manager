<div class="available-sessions-container">
  <div class="header">
    <h2>Available Sessions</h2>
    <p class="subtitle">View and register for available sessions</p>
  </div>

  <div class="filters">
    <div class="filter-group">
      <label>Filter by trainer:</label>
      <select [(ngModel)]="filterTrainer" class="filter-select">
        <option value="">All trainers</option>
        <option *ngFor="let trainer of trainers" [value]="trainer.id">
          {{ trainer.name }}
        </option>
      </select>
    </div>

    <div class="filter-group">
        <label>Filter by session type:</label>
      <select [(ngModel)]="filterSessionType" class="filter-select">
        <option value="">All types</option>
        <option *ngFor="let type of sessionTypes" [value]="type">
          {{ type }}
        </option>
      </select>
    </div>
  </div>

  
  <div *ngIf="loading" class="loading">
    Loading sessions...
  </div>

 
  <div *ngIf="error" class="error">
    {{ error }}
  </div>

 
  <div *ngIf="!loading && !error" class="sessions-grid">
    <div 
      *ngFor="let session of filteredSessions" 
      class="session-card"
      [class.registered]="isRegistered(session.id)"
      [class.full]="isFull(session)">
      
      <div class="session-header">
        <h3>{{ session.type }}</h3>
        <span class="status-badge" [ngClass]="getStatusClass(session)">
          {{ getStatusText(session) }}
        </span>
      </div>

      <div class="session-info">
        <div class="info-row">
          <span class="label">Date:</span>
          <span class="value">{{ formatDate(session.date) }}</span>
        </div>
        <div class="info-row">
          <span class="label">Time:</span>
          <span class="value">{{ session.time }}</span>
        </div>
        <div class="info-row" *ngIf="session.trainer">
          <span class="label">Trainer:</span>
          <span class="value trainer-name">{{ session.trainer.name }}</span>
        </div>
        <div class="info-row" *ngIf="session.trainer">
          <span class="label">Specialty:</span>
          <span class="value">{{ session.trainer.specialty }}</span>
        </div>
        <div class="info-row">
          <span class="label">Capacity:</span>
          <span class="value">
            {{ session.registrations?.length || 0 }}/{{ session.maxParticipants }}
          </span>
        </div>
      </div>

      <div class="session-actions">
        <button 
          *ngIf="!currentUser"
          class="btn-register btn-guest"
          disabled>
          Register to book a session
        </button>
        
        <button 
          *ngIf="currentUser && canRegister(session)"
          (click)="registerToSession(session)"
          class="btn-register">
          Join
        </button>
        <button 
          *ngIf="currentUser && isRegistered(session.id)"
          (click)="unregisterFromSession(session)"
          class="btn-unregister">
          Cancel
        </button>
        <span *ngIf="currentUser && memberInfo && !memberInfo.isActive && !isRegistered(session.id)" class="inactive-message">
          You must select a package to book a session
        </span>
        <span *ngIf="currentUser && isFull(session) && !isRegistered(session.id) && memberInfo?.isActive" class="full-message">
          Session is full
        </span>
      </div>
    </div>
  </div>


  <div *ngIf="!loading && !error && filteredSessions.length === 0" class="empty">
    <p>No available sessions to show.</p>
  </div>
</div>

