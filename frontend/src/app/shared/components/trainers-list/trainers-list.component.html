<div class="trainers-list-container">
  <h2>Our Trainers</h2>

  <div *ngIf="!loading && !error && trainers.length > 0" class="filter-section">
    <label for="specialty-filter">Filter by specialty:</label>
    <select 
      id="specialty-filter"
      [(ngModel)]="selectedSpecialty" 
      (change)="onSpecialtyChange(selectedSpecialty)"
      class="filter-select">
      <option value="">All specialties</option>
      <option *ngFor="let specialty of specialties" [value]="specialty">
        {{ specialty }}
      </option>
    </select>
    <span *ngIf="specialties.length === 0 && !loading" class="no-specialties-info">
      (No available specialties for filtering)
    </span>
  </div>

  <div *ngIf="loading" class="loading">
    Loading trainers...
  </div>

  <div *ngIf="error" class="error">
    {{ error }}
  </div>

  <div *ngIf="!loading && !error && filteredTrainers.length === 0" class="empty">
    <span *ngIf="selectedSpecialty">No trainers with selected specialty.</span>
    <span *ngIf="!selectedSpecialty">No available trainers.</span>
  </div>

  <div *ngIf="!loading && !error && filteredTrainers.length > 0" class="trainers-grid">
    <div *ngFor="let trainer of filteredTrainers" class="trainer-card">
      <div class="trainer-header">
        <h3>{{ trainer.name }}</h3>
        <span class="specialty">{{ trainer.specialty }}</span>
      </div>
      
      <div class="trainer-info">
        <div class="rating-section" *ngIf="getAverageRating(trainer.id) > 0">
          <div class="rating-display">
            <span class="stars">{{ getStars(getAverageRating(trainer.id)) }}</span>
            <span class="rating-value">{{ getAverageRating(trainer.id).toFixed(1) }}</span>
          </div>
        </div>
        <div class="rating-section" *ngIf="getAverageRating(trainer.id) === 0">
          <span class="no-rating">No ratings</span>
        </div>
        <div *ngIf="trainer.experienceYears" class="info-item">
          <span class="label">Experience:</span>
          <span class="value">{{ trainer.experienceYears }} {{ trainer.experienceYears === 1 ? 'year' : 'years' }}</span>
        </div>
        <div *ngIf="trainer.gender" class="info-item">
          <span class="label">Gender:</span>
          <span class="value">{{ trainer.gender }}</span>
        </div>
        <div class="rate-button" *ngIf="canRate()">
          <button 
            *ngIf="!hasRated(trainer.id)"
            (click)="rateTrainer(trainer.id)"
            class="btn-rate">
            Rate trainer
          </button>
          <button 
            *ngIf="hasRated(trainer.id)"
            (click)="rateTrainer(trainer.id)"
            class="btn-rate-update">
            Update rating ({{ getMyRating(trainer.id)?.rating }}â­)
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<app-rating-modal
  *ngIf="showRatingModal && selectedTrainer"
  [trainerName]="selectedTrainer.name"
  [existingRating]="selectedTrainerRating"
  (close)="closeRatingModal()"
  (submit)="submitRating($event)">
</app-rating-modal>

